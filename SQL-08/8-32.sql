select книги.ид_кни, книги.название, гонорары.аванс, sum(книги.цена * книги.продажи) as [Выручка]
from книги
inner join гонорары on книги.ид_кни = гонорары.ид_кни
group by книги.ид_кни, книги.название, гонорары.аванс
having sum(книги.цена * книги.продажи) > 10.0 * гонорары.аванс
order by 4 desc;
